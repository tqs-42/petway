{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { useFocusEffect } from '@react-navigation/native';\nimport Deliveries from \"../components/Deliveries\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar DeliveriesScreen = function DeliveriesScreen(_ref) {\n  var navigation = _ref.navigation;\n  var pendentDeliveries = [{\n    id: 1,\n    store: \"Petlandia\",\n    date: \"22/06/2022 16:15:22\"\n  }, {\n    id: 2,\n    store: \"Perrito\",\n    date: \"22/06/2022 16:15:24\"\n  }];\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      deliveries = _useState2[0],\n      setDeliveries = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      token = _useState6[0],\n      setToken = _useState6[1];\n\n  useFocusEffect(React.useCallback(function () {\n    function getRiderInfo() {\n      var data, rider;\n      return _regeneratorRuntime.async(function getRiderInfo$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"user\"));\n\n            case 2:\n              data = _context.sent;\n              rider = data ? JSON.parse(JSON.stringify(data)) : null;\n              setToken(rider ? token : null);\n              fetchData();\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    getRiderInfo();\n\n    function fetchData() {\n      return _regeneratorRuntime.async(function fetchData$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              console.log(\"rider\", rider);\n              console.log(\"rider.token\", rider.token);\n              fetch(\"http://localhost:6869/deliveries/deliveriesByStatus?status=PENDING\", {\n                headers: {\n                  'Access-Control-Allow-Origin': '*',\n                  'Authorization': 'Bearer ' + rider.token\n                }\n              }).then(function (response) {\n                return response.json();\n              }).then(function (data) {\n                setDeliveries(data);\n              }).catch(function (reason) {\n                setError(true);\n              });\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }, []));\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Text, {\n      style: styles.title,\n      children: \"Pendent Deliveries\"\n    }), deliveries == null ? _jsx(Text, {\n      children: \"No deliveries to accept...\"\n    }) : _jsx(Deliveries, {\n      deliveries: pendentDeliveries\n    })]\n  });\n};\n\nexport default DeliveriesScreen;\nvar styles = StyleSheet.create({\n  title: {\n    fontSize: 32\n  },\n  container: {\n    flex: 1,\n    padding: 20,\n    paddingTop: 20,\n    paddingBottom: 20,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","useFocusEffect","Deliveries","AsyncStorage","DeliveriesScreen","navigation","pendentDeliveries","id","store","date","deliveries","setDeliveries","error","setError","token","setToken","useCallback","getRiderInfo","getItem","data","rider","JSON","parse","stringify","fetchData","console","log","fetch","headers","then","response","json","catch","reason","styles","container","title","StyleSheet","create","fontSize","flex","padding","paddingTop","paddingBottom","backgroundColor","alignItems","justifyContent"],"sources":["/home/ricardo/Documents/3_ANO/TQS/petway/projRiderApp/src/screens/DeliveriesScreen.js"],"sourcesContent":["\n\n\nimport React, { useEffect, useState } from 'react';\nimport { View, Text, Button, StyleSheet, TouchableOpacity } from 'react-native';\nimport { useFocusEffect } from '@react-navigation/native';\nimport Deliveries from '../components/Deliveries';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\n\nconst DeliveriesScreen = ({ navigation }) => {\n\n\n  const pendentDeliveries = [\n    {\n      id: 1,\n      store: \"Petlandia\",\n      date: \"22/06/2022 16:15:22\"\n    },\n    {\n      id: 2,\n      store: \"Perrito\",\n      date: \"22/06/2022 16:15:24\"\n    },\n  ];\n\n\n  const [deliveries, setDeliveries] = useState(null);\n  const [error, setError] = useState(false);\n  const [token, setToken] = useState({});\n\n  // fetch data from the API\n  useFocusEffect(\n    React.useCallback(() => {\n\n      async function getRiderInfo() {\n        let data = await AsyncStorage.getItem(\"user\")\n        let rider = data ? JSON.parse(JSON.stringify(data)) : null\n        setToken(rider ? token : null)\n        fetchData()\n      }\n\n      getRiderInfo()\n\n      async function fetchData() {\n\n        console.log(\"rider\", rider)\n        console.log(\"rider.token\", rider.token)\n\n\n        fetch(\n          `http://localhost:6869/deliveries/deliveriesByStatus?status=PENDING`,\n          {\n            headers: { \n                       'Access-Control-Allow-Origin': '*',\n                       'Authorization' : 'Bearer ' + rider.token,\n                      }\n          }\n        )\n          .then(response => response.json())\n          .then(data => {\n            setDeliveries(data)\n          })\n          .catch((reason) => {\n            setError(true)\n          })\n      }\n\n    }, [])\n  );\n\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>Pendent Deliveries</Text>\n      {\n        deliveries == null ?\n\n          <Text>No deliveries to accept...</Text>\n\n          :\n\n          <Deliveries deliveries={pendentDeliveries} />\n\n        }\n    </View >\n\n  );\n};\n\nexport default DeliveriesScreen;\n\nconst styles = StyleSheet.create({\n  title: {\n    fontSize: 32\n  },\n  container: {\n    flex: 1,\n    padding: 20,\n    paddingTop: 20,\n    paddingBottom: 20,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n  }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}